{"version":3,"file":"angular1.js","sources":["../src/utilities.ts","../src/index.ts","../src/angular1.ts"],"sourcesContent":["// Roughly taken from MDN\nexport const assign = function(target, ...args) { // .length of function is 2\n  args;\n  if (target == null) { // TypeError if undefined or null\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  var to = Object(target);\n\n  for (var index = 1; index < arguments.length; index++) {\n    var nextSource = arguments[index];\n\n    if (nextSource != null) { // Skip over if undefined or null\n      for (var nextKey in nextSource) {\n        // Avoid bugs when hasOwnProperty is shadowed\n        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n          to[nextKey] = nextSource[nextKey];\n        }\n      }\n    }\n  }\n  return to;\n};","import {assign} from './utilities';\n\nconst CAROUSEL_STYLES = `\n  .progress-dots  {\n    text-align: center;\n  }\n\n  .progress-dots > li.active {\n    background: #24282a;\n  }\n\n  .progress-dots > li {\n    border-radius: 50%;\n    display: inline-block;\n    margin: 0 5px;\n    width: 8px;\n    height: 8px;\n    border: 1px solid #24282a;\n  }\n\n  .carousel-item {\n    width: 90%;\n    flex: 0 0 auto;\n  }\n`;\n\nexport default class AyCarousel {\n\n  static documentStyleAdded : boolean = false;\n\n  startX : number = 0;\n  startY : number = 0;\n  initialIndex : number;\n  initialIndexSetOnce : boolean = false;\n  currentTranslate : number = 0;\n  lastTranslate : number = 0;\n  currentlyDragging : boolean = false;\n  passedMoveThreshold : boolean = false;\n  callbacks : any = {};\n  cards : HTMLElement[];\n  cardWidth : number;\n  index : number = 0;\n  startIndex: number;\n  carousel : HTMLElement;\n  dotContainer : HTMLUListElement;\n  dots : HTMLLIElement[] = [];\n  totalMove;\n  lastPos;\n  amplitude = 0;\n  velocity = 0;\n  frame;\n  timestamp = 0;\n  target;\n  velocityInterval;\n  config;\n  carouselParent;\n  resizeTimeoutId : number;\n  destroyed : boolean = false;\n  onIndexChange : Function;\n  onMove : Function;\n\n  constructor(carousel : HTMLElement, config?, initialIndex=0, onIndexChange? : Function, onMove? : Function) {\n    if (! carousel) {\n      return;\n    }\n\n    this.config = this.setupConfig(config);\n    this.initialIndex = initialIndex;\n    if (onIndexChange) {\n      this.onIndexChange = onIndexChange;\n    }\n    if (onMove) {\n      this.onMove = onMove;\n    }\n    this.carousel = carousel;\n\n    if (this.config.includeStyle) {\n      if (! AyCarousel.documentStyleAdded) {\n        const carStyle = document.createElement('style');\n        carStyle.appendChild(document.createTextNode(CAROUSEL_STYLES));\n\n        let insertPoint: HTMLElement | null;\n        if (insertPoint = document.querySelector('link')) {\n          insertPoint.parentNode!.insertBefore(carStyle, insertPoint);\n        } else if (insertPoint = document.querySelector('style')) {\n          insertPoint.parentNode!.insertBefore(carStyle, insertPoint);\n        } else if (insertPoint = document.querySelector('head')) {\n          insertPoint.appendChild(carStyle);\n        } else {\n          document.appendChild(carStyle);\n        }\n        AyCarousel.documentStyleAdded = true;\n      }\n\n      this.carousel.setAttribute('style',  `position: relative; width: 100%; display: flex; align-items: stretch;`);\n    }\n\n    this.callbacks.onDragStart = this.onDragStart.bind(this);\n    this.callbacks.onDragMove = this.onDragMove.bind(this);\n    this.callbacks.onDragEnd = this.onDragEnd.bind(this);\n    this.callbacks.onDotClick = this.onDotClick.bind(this);\n    this.callbacks.onDotKey = this.onDotKey.bind(this);\n    this.callbacks.onWindowResize = this.handleResize.bind(this);\n    this.callbacks.onResizeFollowUp = this.followUpResize.bind(this);\n    this.callbacks.onTransitionEnd = (evt : TransitionEvent) => {\n      if (evt.target === this.carousel) {\n        this.rescale();\n      }\n    };\n    this.callbacks.onClick = (evt : MouseEvent) => {\n      if (this.totalMove && (this.totalMove.x > this.config.moveThreshold || this.totalMove.y > this.config.moveThreshold)) {\n        evt.preventDefault();\n        evt.stopPropagation();\n      }\n    };\n\n    this.carousel.addEventListener('touchstart', this.callbacks.onDragStart);\n    this.carousel.addEventListener('mousedown', this.callbacks.onDragStart);\n    this.carousel.addEventListener('transitionend', this.callbacks.onTransitionEnd);\n    this.carousel.addEventListener('click', this.callbacks.onClick, true);\n    window.addEventListener('resize', this.callbacks.onWindowResize);\n\n    this.updateItems();\n  }\n\n  updateItems() {\n    this.cards = [];\n    for (let i=0, l=this.carousel.children.length; i<l; i++) {\n      let child = <HTMLElement>this.carousel.children[i];\n      if ((! this.config.cardFilterClass) || child.classList.contains(this.config.cardFilterClass)) {\n        this.cards.push(child);\n      }\n    }\n\n    if (this.cards.length > this.initialIndex && !this.initialIndexSetOnce) {\n      this.setIndex(this.initialIndex);\n      this.initialIndexSetOnce = true;\n    }\n\n    this.handleResize(false);\n    this.rescale();\n    this.translate(this.calcOS(this.index), 0, undefined, false);\n\n    window.requestAnimationFrame(_ => this.rescale());\n\n    if (this.dotContainer) {\n      this.removeDots(false);\n    } else {\n      this.dotContainer = document.createElement('ul');\n      this.dotContainer.classList.add('progress-dots');\n      // Inserting before the carousel's nextSibling <=> Inserting after the carousel\n      this.carouselParent.element.insertBefore(this.dotContainer, this.carousel.nextSibling);\n    }\n\n    if (this.config.enableDots && this.cards.length > 1) {\n      for(let i = 0; i < this.cards.length; i++) {\n        this.dots.push(document.createElement('li'));\n        this.dotContainer.insertAdjacentElement('beforeend', this.dots[i]);\n        this.dots[i].addEventListener('touchstart', this.callbacks.onDotClick);\n        this.dots[i].addEventListener('click', this.callbacks.onDotClick);\n        this.dots[i].addEventListener('keydown', this.callbacks.onDotKey);\n        this.dots[i].tabIndex = 0;\n      }\n      this.dots[this.index].className = 'active';\n    }\n  }\n\n  handleResize(snap : boolean = true) {\n    if (this.resizeTimeoutId) {\n      clearTimeout(this.resizeTimeoutId);\n    }\n    this.followUpResize(snap);\n    this.resizeTimeoutId = window.setTimeout(this.callbacks.onResizeFollowUp, 150, snap);\n  }\n\n  followUpResize(snap : boolean = true): void {\n    this.resizeTimeoutId = 0;\n\n    let carouselParent = this.carousel.parentElement;\n\n    if (carouselParent) {\n      let parentRect = carouselParent.getBoundingClientRect();\n\n      this.carouselParent = {\n        element: carouselParent,\n        width: parentRect.width,\n        left: parentRect.left,\n        right: parentRect.right\n      };\n    }\n\n    if (this.cards.length === 0) {\n      return;\n    }\n\n    this.cardWidth = this.cards[0].offsetWidth;\n    if (snap) {\n      this.snap(this.index, undefined, true);\n    }\n  }\n\n  onDragStart(e) {\n    if (this.cards.length < 2) {\n      return;\n    } else if (this.currentlyDragging) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n    this.currentlyDragging = true;\n    this.passedMoveThreshold = false;\n\n    this.startIndex = this.index;\n\n    const touches =  e.touches ? e.touches[0] : e;\n    const {pageX, pageY} = touches;\n\n    this.lastTranslate = this.currentTranslate;\n\n    this.startX = pageX;\n    this.startY = pageY;\n\n    this.totalMove = {\n      x: 0,\n      y: 0\n    };\n\n    this.lastPos = {\n      x: 0,\n      y: 0\n    };\n\n    // Velocity Stuff\n    this.velocity = this.amplitude = 0;\n    this.frame = this.currentTranslate;\n    this.timestamp = Date.now();\n\n    this.velocityInterval = window.setInterval(this.calcVelocity.bind(this), 100);\n\n    this.carousel.addEventListener('mousemove', this.callbacks.onDragMove);\n    this.carousel.addEventListener('touchmove', this.callbacks.onDragMove);\n\n    this.carousel.addEventListener('touchend', this.callbacks.onDragEnd);\n    this.carousel.addEventListener('mouseup', this.callbacks.onDragEnd);\n    this.carousel.addEventListener('mouseleave', this.callbacks.onDragEnd);\n  }\n\n  calcVelocity() {\n    // Calculations from:\n    // https://ariya.io/2013/11/javascript-kinetic-scrolling-part-2\n\n    const now = Date.now();\n    const elapsed = now - this.timestamp;\n    this.timestamp = now;\n    const delta = this.currentTranslate - this.frame;\n    this.frame = this.currentTranslate;\n\n    // Distance moved, divided by time elapsed (+1 to avoid divide by 0)\n    // Multiplied by 1000 ms/sec\n    const v = 1000 * delta / (1 + elapsed);\n\n    return this.velocity = 0.8 * v + 0.2 * this.velocity;\n  }\n\n  momentumScroll(stopPoint) {\n    if (this.destroyed) {\n      return;\n    }\n\n    if(this.amplitude) {\n      const elapsed = Date.now() - this.timestamp;\n\n      const delta = -this.amplitude * Math.exp(-elapsed / (this.config.decelerationRate));\n\n      if(this.startIndex !== this.index && this.config.limitMomentumToOnePage) {\n        // Limit distance of move to +/- 1 from the startIndex\n        const moveDiff = Math.max(-1, Math.min(1, this.index - this.startIndex));\n        this.snap(this.startIndex + moveDiff);\n      } else if(delta > stopPoint || delta < -stopPoint) {\n        const outOfBoundsLeft = this.target+delta > (this.config.edgeBounceProportion * this.cardWidth);\n        const outOfBoundsRight = this.target+delta < (this.calcOS(this.cards.length-1) - (this.config.edgeBounceProportion * this.cardWidth));\n        if(outOfBoundsLeft || outOfBoundsRight) {\n          return this.snap(this.index);\n        }\n        this.translate(this.target + delta, 0);\n        window.requestAnimationFrame(_ => this.momentumScroll(stopPoint));\n      } else {\n        this.snap(this.index);\n      }\n    }\n  }\n\n  onDragMove(e) {\n    const touches =  e.touches ? e.touches[0] : e;\n    const {pageX, pageY} = touches;\n    const move = {\n      x: pageX - this.startX,\n      y: pageY - this.startY\n    };\n\n    // Keep track of the total distance moved right/left in the move\n    this.totalMove.x += Math.abs(move.x - this.lastPos.x);\n    this.totalMove.y += Math.abs(move.y - this.lastPos.y);\n    this.lastPos = {\n      x: move.x,\n      y: move.y\n    };\n\n    // Don't do anything if the move doesn't exceed our threshold\n    if (this.totalMove.x < this.config.moveThreshold && this.totalMove.y < this.config.moveThreshold) {\n      return;\n    }\n    if (! this.passedMoveThreshold) {\n      this.passedMoveThreshold = true;\n      this.startX = pageX;\n      this.startY = pageY;\n      return;\n    }\n\n    // If the swipe is vertical, allow page to scroll instead of moving carousel\n    if(this.totalMove.x > this.totalMove.y) {\n      e.preventDefault();\n\n      this.translate(this.lastTranslate + move.x, 0);\n      this.velocity = this.calcVelocity();\n\n    }\n  }\n\n  calculateIndex() {\n    let edgeToCardDist = (this.carouselParent.width - this.cardWidth) / 2;\n    let index = Math.round((edgeToCardDist - this.currentTranslate) / this.cardWidth);\n    return Math.max(0, Math.min(this.cards.length-1, (index)));\n  }\n\n  onDotClick(e) {\n    let i = this.dots.indexOf(e.target);\n    this.setIndex(i);\n    this.snap(this.index);\n  }\n\n  onDotKey(e) {\n    if (e.keyCode === 32 || e.keyCode === 13) {\n      let i = this.dots.indexOf(e.target);\n      e.preventDefault();\n      e.stopPropagation();\n      this.setIndex(i);\n      this.snap(this.index);\n    }\n  }\n\n  setIndex(index: number) {\n    const oldIndex = this.index;\n\n    // Don't let index go outside bounds\n    this.index = Math.max(Math.min(index, this.cards.length-1), 0);\n\n    // Update dots, TODO: animate this\n    if (oldIndex !== this.index && this.dots && this.dots[oldIndex] && this.dots[this.index]) {\n      this.dots[oldIndex].className = '';\n      this.dots[this.index].className = 'active';\n    }\n\n    if (oldIndex !== this.index) {\n      this.onIndexChange && this.onIndexChange({ index: this.index });\n    }\n  }\n\n  snap(nextIndex? : number, direction? : string, instant? : boolean) {\n    if(direction) {\n      direction == 'right' ? nextIndex = this.index+1 : nextIndex = this.index-1;\n    } else if(nextIndex !== undefined) {\n      nextIndex = Math.min(Math.max(nextIndex, 0), this.cards.length - 1);\n    } else {\n      return;\n    }\n    this.index = nextIndex;\n\n    const nextOffset = this.calcOS(this.index);\n\n    const ease = 'ease';\n    const distance = Math.abs(this.currentTranslate - nextOffset);\n\n    const duration = instant ? 200 : Math.floor(distance*1.25) + this.config.snapSpeedConstant;\n\n    this.translate(nextOffset, duration, ease);\n  }\n\n  onDragEnd() {\n    this.currentlyDragging = false;\n\n    this.carousel.removeEventListener('mousemove', this.callbacks.onDragMove);\n    this.carousel.removeEventListener('touchmove', this.callbacks.onDragMove);\n\n    this.carousel.removeEventListener('touchend',this.callbacks.onDragEnd);\n    this.carousel.removeEventListener('mouseup', this.callbacks.onDragEnd);\n    this.carousel.removeEventListener('mouseleave', this.callbacks.onDragEnd);\n\n    window.clearInterval(this.velocityInterval);\n    if(this.velocity > 0.5 || this.velocity < -0.5) {\n      this.amplitude = (1-this.config.heaviness) * this.velocity;\n      this.target = Math.round(this.currentTranslate + this.amplitude);\n\n      this.index = this.calculateIndex();\n      window.requestAnimationFrame(_ => this.momentumScroll(this.config.momentumSnapVelocityThreshold));\n    } else {\n      this.snap(this.index);\n    }\n  }\n\n  translate(x : number, length : number, fn? : string, updateIndex : boolean = true) {\n    let oldTranslate = this.currentTranslate;\n    this.currentTranslate = x;\n\n    if (!('transform' in this.carousel.style)) {\n      this.carousel.style!['transition'] = '-webkit-transform';\n      this.carousel.style!['webkitTransform'] = `translate3d(${x}px,0px,0px)`;\n    } else {\n      this.carousel.style['transition'] = 'transform';\n      this.carousel.style['transform'] = `translate3d(${x}px,0px,0px)`;\n    }\n    this.carousel.style['transitionDuration'] = `${length}ms`;\n\n    if(fn) {\n      this.carousel.style['transitionTimingFunction'] = fn;\n    }\n    if(length === 0 && updateIndex) {\n      // We only want to calculate the index if we're responding to a user drag\n      // i.e. a 0 length transition\n      this.setIndex(this.calculateIndex());\n    }\n    window.requestAnimationFrame(_ => this.rescale());\n    if (oldTranslate !== this.currentTranslate) {\n      this.onMove && this.onMove({ proportion: -this.currentTranslate / ((this.cards.length-1)*this.cardWidth), duration: length });\n    }\n  }\n\n  proportionVisible(index : number) : number {\n    let prop = 1 - Math.abs((this.calcOS(index) - this.currentTranslate) / this.cardWidth);\n    return Math.max(0, prop);\n  }\n\n  rescale() {\n    if (this.destroyed || this.config.minCardScale >= 1) {\n      return;\n    }\n\n    // Rescale current card and 2 cards in either direction\n    const from = Math.max(this.index-2 ,0);\n    const to = Math.min(this.index+2, this.cards.length-1);\n\n    for(let i = from; i<=to; i++) {\n      const scaler = Math.min(Math.max(this.proportionVisible(i)+0.25, this.config.minCardScale), 1);\n\n      this.cards[i].style['transform'] = `scale(${scaler})`;\n      this.cards[i].style['transitionTimingFunction'] = 'ease';\n      this.cards[i].style['transitionDuration'] = `${this.config.shrinkSpeed}ms`;\n    }\n  }\n\n  calcOS(i) {\n    // Width of container - Width of card = All the extra space\n    // Divide this by 2 to get desired distance from edge on either side of card\n    const edgeToCardDist = (this.carouselParent.width - this.cardWidth)/2;\n\n    // Translating to the left of the desired card, minus our desired edge dist\n    // Multiplied by -1 because we are translating to the right\n    let centeredPosition = (this.cardWidth*i - edgeToCardDist) * -1;\n\n    if (! this.config.edgeShifting) {\n      return centeredPosition;\n    }\n\n    if (this.cards.length <= 1) {             //If there's only one item, center it\n      return centeredPosition;\n    } else if (i === 0) {                     //If it's the first of multiple, align left\n      return 0;\n    } else if (i === this.cards.length - 1) { //If it's the last of multiple, align right\n      return (this.carouselParent.width - this.cardWidth) - (this.cardWidth * (this.cards.length - 1));\n    } else {                                  //Otherwise it's in the middle of multiple, so center it\n      return centeredPosition;\n    }\n  }\n\n  cleanUp() {\n    this.removeDots(true);\n    this.carousel.removeEventListener('touchstart', this.callbacks.onDragStart);\n    this.carousel.removeEventListener('mousedown', this.callbacks.onDragStart);\n    this.carousel.removeEventListener('transitionend', this.callbacks.onTransitionEnd);\n    this.carousel.removeEventListener('click', this.callbacks.onClick);\n    window.removeEventListener('resize', this.callbacks.onWindowResize);\n    if (this.resizeTimeoutId) {\n      clearTimeout(this.resizeTimeoutId);\n    }\n    this.destroyed = true;\n  }\n\n  removeDots(includingContainer : boolean = false) {\n    while (this.dots.length > 0) {\n      let dot = this.dots.pop();\n      if (dot === undefined) {\n        continue;\n      }\n      dot.removeEventListener('touchstart', this.callbacks.onDotClick);\n      dot.removeEventListener('click', this.callbacks.onDotClick);\n      dot.removeEventListener('keydown', this.callbacks.onDotKey);\n      this.dotContainer.removeChild(dot);\n    }\n    if (includingContainer && this.dotContainer && this.dotContainer.parentElement) {\n       this.dotContainer.parentElement.removeChild(this.dotContainer);\n    }\n  }\n\n  setupConfig(config?) {\n    const defaultConfig = {\n      decelerationRate: 700, // How fast we decelerate\n      momentumSnapVelocityThreshold: 105, // Velocity at which cards snap\n      minCardScale: 0.9, // Smallest that partially-viewable cards can scale to\n      snapSpeedConstant: 300, // Constant ms to be added to snapping duration\n      heaviness: 0.675, // Scale of 0 to 1, higher = less momentum after release\n      shrinkSpeed: 150, // Speed of card scaling transition, in ms\n      moveThreshold: 10, // Min accumulative x + y distance travelled by pointer before carousel will move and click events are cancelled\n      edgeBounceProportion: 0.25, // How far beyond the scroll limits the carousel can travel with momentum before snapping (proportion of card width)\n      cardFilterClass: '', // If non-falsey, only carousel children with a class matching the supplied value will be itemised as cards\n      edgeShifting: true, // Edge shifting aligns the first and last carousel items to the left and right edge of the parent element, but it's not always wanted. Setting this false centers every item.\n      enableDots: true,\n      includeStyle: false,\n      limitMomentumToOnePage: false\n    };\n    return assign({}, defaultConfig, config);\n  }\n}\n","/*! Copyright 2016 Ayogo Health Inc. */\n\nimport * as angular from 'angular';\nimport AyCarousel from './index';\n\nconst modName = 'ayCarousel';\n\nangular.module(modName, [])\n.directive('carousel', function() {\n  return {\n    restrict: 'E',\n    scope: {\n      config: '=',\n      index: '<?',\n      initialIndex: '@',\n      onIndexChange: '&',\n      onMove: '&',\n      disable: '<?'\n    },\n    link: function($scope: any, $element) {\n      let el = $element[0] as HTMLElement;\n      let carousel, mutationObserver;\n\n      if(!$scope.disable) {\n        carousel = new AyCarousel(el, $scope.config, $scope.initialIndex, $scope.onIndexChange, $scope.onMove);\n\n        mutationObserver = new MutationObserver(() => {\n          carousel.updateItems();\n        });\n        mutationObserver.observe(el, { childList: true });\n      }\n\n      $scope.$watch('index', (newVal) => {\n        let index = parseInt(newVal, 10);\n\n        if(!isNaN(index)) {\n          if(carousel) {\n            carousel.setIndex(index);\n            carousel.snap(index);\n          }\n        }\n      });\n\n      $scope.$watch('disable', newVal => {\n        if(!newVal) {\n          carousel = new AyCarousel(el, $scope.config, $scope.initialIndex, $scope.onIndexChange, $scope.onMove);\n\n          mutationObserver = new MutationObserver(() => {\n            carousel.updateItems();\n          });\n          mutationObserver.observe(el, { childList: true });\n        } else if(carousel) {\n          carousel.snap(0);\n          carousel.cleanUp();\n          mutationObserver.disconnect();\n        }\n      });\n\n      $scope.$on('$destroy', () => {\n        if (mutationObserver) {\n          mutationObserver.disconnect();\n        }\n\n        carousel.cleanUp();\n      });\n    }\n  };\n});\n\nexport default modName;\n"],"names":["angular.module"],"mappings":"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"}