{"version":3,"file":"index.js","sources":["../src/utilities.ts","../src/index.ts"],"sourcesContent":["// Roughly taken from MDN\r\nexport const assign = function(target, ...args) { // .length of function is 2\r\n  args;\r\n  if (target == null) { // TypeError if undefined or null\r\n    throw new TypeError('Cannot convert undefined or null to object');\r\n  }\r\n\r\n  var to = Object(target);\r\n\r\n  for (var index = 1; index < arguments.length; index++) {\r\n    var nextSource = arguments[index];\r\n\r\n    if (nextSource != null) { // Skip over if undefined or null\r\n      for (var nextKey in nextSource) {\r\n        // Avoid bugs when hasOwnProperty is shadowed\r\n        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n          to[nextKey] = nextSource[nextKey];\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return to;\r\n};","import {assign} from './utilities';\r\n\r\nconst CAROUSEL_STYLES = `\r\n  .progress-dots  {\r\n    text-align: center;\r\n  }\r\n\r\n  .progress-dots > li.active {\r\n    background: #24282a;\r\n  }\r\n\r\n  .progress-dots > li {\r\n    border-radius: 50%;\r\n    display: inline-block;\r\n    margin: 0 5px;\r\n    width: 8px;\r\n    height: 8px;\r\n    border: 1px solid #24282a;\r\n  }\r\n\r\n  .carousel-item {\r\n    width: 90%;\r\n    flex: 0 0 auto;\r\n  }\r\n`;\r\n\r\nexport default class AyCarousel {\r\n\r\n  static documentStyleAdded : boolean = false;\r\n\r\n  startX : number = 0;\r\n  startY : number = 0;\r\n  initialIndex : number;\r\n  initialIndexSetOnce : boolean = false;\r\n  currentTranslate : number = 0;\r\n  lastTranslate : number = 0;\r\n  callbacks : any = {};\r\n  cards : HTMLElement[];\r\n  cardWidth : number;\r\n  index : number = 0;\r\n  carousel : HTMLElement;\r\n  dotContainer : HTMLUListElement;\r\n  dots : HTMLLIElement[] = [];\r\n  totalMove;\r\n  lastPos;\r\n  amplitude = 0;\r\n  velocity = 0;\r\n  frame;\r\n  timestamp = 0;\r\n  target;\r\n  velocityInterval;\r\n  config;\r\n  carouselParent;\r\n  resizeTimeoutId : number;\r\n  destroyed : boolean = false;\r\n\r\n  constructor(carousel : HTMLElement, config?, initialIndex=0) {\r\n    if (! carousel) {\r\n      return;\r\n    }\r\n\r\n    this.config = this.setupConfig(config);\r\n    this.initialIndex = initialIndex;\r\n    this.carousel = carousel;\r\n\r\n    if (this.config.includeStyle) {\r\n      if (! AyCarousel.documentStyleAdded) {\r\n        const carStyle = document.createElement('style');\r\n        carStyle.appendChild(document.createTextNode(CAROUSEL_STYLES));\r\n\r\n        let insertPoint: HTMLElement | null;\r\n        if (insertPoint = document.querySelector('link')) {\r\n          insertPoint.parentNode!.insertBefore(carStyle, insertPoint);\r\n        } else if (insertPoint = document.querySelector('style')) {\r\n          insertPoint.parentNode!.insertBefore(carStyle, insertPoint);\r\n        } else if (insertPoint = document.querySelector('head')) {\r\n          insertPoint.appendChild(carStyle);\r\n        } else {\r\n          document.appendChild(carStyle);\r\n        }\r\n        AyCarousel.documentStyleAdded = true;\r\n      }\r\n      \r\n      this.carousel.setAttribute('style',  `position: relative; width: 100%; display: flex; align-items: stretch;`);\r\n    }\r\n\r\n    this.cards = <any>this.carousel.children;\r\n\r\n    this.callbacks.onDragStart = this.onDragStart.bind(this);\r\n    this.callbacks.onDragMove = this.onDragMove.bind(this);\r\n    this.callbacks.onDragEnd = this.onDragEnd.bind(this);\r\n    this.callbacks.onDotClick = this.onDotClick.bind(this);\r\n    this.callbacks.onDotKey = this.onDotKey.bind(this);\r\n    this.callbacks.onWindowResize = this.handleResize.bind(this);\r\n    this.callbacks.onResizeFollowUp = this.followUpResize.bind(this);\r\n    this.callbacks.onTransitionEnd = (evt : TransitionEvent) => {\r\n      if (evt.target === this.carousel) {\r\n        this.rescale();\r\n      }\r\n    };\r\n    this.callbacks.onClick = (evt : MouseEvent) => {\r\n      if (this.totalMove && (this.totalMove.x > this.config.moveThreshold || this.totalMove.y > this.config.moveThreshold)) {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n      }\r\n    };\r\n\r\n    this.carousel.addEventListener('touchstart', this.callbacks.onDragStart);\r\n    this.carousel.addEventListener('mousedown', this.callbacks.onDragStart);\r\n    this.carousel.addEventListener('transitionend', this.callbacks.onTransitionEnd);\r\n    this.carousel.addEventListener('click', this.callbacks.onClick, true);\r\n    window.addEventListener('resize', this.callbacks.onWindowResize);\r\n    \r\n    this.updateItems();\r\n  }\r\n\r\n  updateItems() {\r\n    if (this.cards.length > this.initialIndex && !this.initialIndexSetOnce) {\r\n      this.setIndex(this.initialIndex);\r\n      this.initialIndexSetOnce = true;\r\n    }\r\n\r\n    this.handleResize(false);\r\n    this.rescale();\r\n    this.translate(this.calcOS(this.index), 0, undefined, false);\r\n\r\n    this.currentTranslate = 0;\r\n\r\n    window.requestAnimationFrame(_ => this.rescale());\r\n\r\n    if (this.dotContainer) {\r\n      this.removeDots(false);\r\n    } else {\r\n      this.dotContainer = document.createElement('ul');\r\n      this.dotContainer.classList.add('progress-dots');\r\n      // Inserting before the carousel's nextSibling <=> Inserting after the carousel\r\n      this.carouselParent.element.insertBefore(this.dotContainer, this.carousel.nextSibling);\r\n    }\r\n\r\n    if (this.config.enableDots && this.cards.length > 1) {\r\n      for(let i = 0; i < this.cards.length; i++) {\r\n        this.dots.push(document.createElement('li'));\r\n        this.dotContainer.insertAdjacentElement('beforeend', this.dots[i]);\r\n        this.dots[i].addEventListener('touchstart', this.callbacks.onDotClick);\r\n        this.dots[i].addEventListener('click', this.callbacks.onDotClick);\r\n        this.dots[i].addEventListener('keydown', this.callbacks.onDotKey);\r\n        this.dots[i].tabIndex = 0;\r\n      }\r\n      this.dots[this.index].className = 'active';\r\n    }\r\n  }\r\n\r\n  handleResize(snap : boolean = true) {\r\n    if (this.resizeTimeoutId) {\r\n      clearTimeout(this.resizeTimeoutId);\r\n    }\r\n    this.followUpResize(snap);\r\n    this.resizeTimeoutId = setTimeout(this.callbacks.onResizeFollowUp, 150, snap);\r\n  }\r\n  \r\n  followUpResize(snap : boolean = true): void {\r\n    this.resizeTimeoutId = 0;\r\n    \r\n    let carouselParent = this.carousel.parentElement;\r\n\r\n    if (carouselParent) {\r\n      let parentRect = carouselParent.getBoundingClientRect();\r\n\r\n      this.carouselParent = {\r\n        element: carouselParent,\r\n        width: parentRect.width,\r\n        left: parentRect.left,\r\n        right: parentRect.right\r\n      };\r\n    }\r\n\r\n    if (this.cards.length === 0) {\r\n      return;\r\n    }\r\n\r\n    this.cardWidth = this.cards[0].offsetWidth;\r\n    if (snap) {\r\n      this.snap(this.index, undefined, true);\r\n    }\r\n  }\r\n\r\n  onDragStart(e) {\r\n    if(this.cards.length < 2) {\r\n      return;\r\n    }\r\n\r\n    const touches =  e.touches ? e.touches[0] : e;\r\n    const {pageX, pageY} = touches;\r\n\r\n    this.lastTranslate = this.currentTranslate;\r\n\r\n    this.startX = pageX;\r\n    this.startY = pageY;\r\n\r\n    this.totalMove = {\r\n      x: 0,\r\n      y: 0\r\n    };\r\n\r\n    this.lastPos = {\r\n      x: 0,\r\n      y: 0\r\n    };\r\n\r\n    // Velocity Stuff\r\n    this.velocity = this.amplitude = 0;\r\n    this.frame = this.currentTranslate;\r\n    this.timestamp = Date.now();\r\n\r\n    this.velocityInterval = window.setInterval(this.calcVelocity.bind(this), 100);\r\n\r\n    this.carousel.addEventListener('mousemove', this.callbacks.onDragMove);\r\n    this.carousel.addEventListener('touchmove', this.callbacks.onDragMove);\r\n    \r\n    this.carousel.addEventListener('touchend', this.callbacks.onDragEnd);\r\n    this.carousel.addEventListener('mouseup', this.callbacks.onDragEnd);\r\n    this.carousel.addEventListener('mouseleave', this.callbacks.onDragEnd);\r\n  }\r\n\r\n  calcVelocity() {\r\n    // Calculations from: \r\n    // https://ariya.io/2013/11/javascript-kinetic-scrolling-part-2\r\n\r\n    const now = Date.now();\r\n    const elapsed = now - this.timestamp;\r\n    this.timestamp = now;\r\n    const delta = this.currentTranslate - this.frame;\r\n    this.frame = this.currentTranslate;\r\n\r\n    // Distance moved, divided by time elapsed (+1 to avoid divide by 0)\r\n    // Multiplied by 1000 ms/sec\r\n    const v = 1000 * delta / (1 + elapsed);\r\n\r\n    return this.velocity = 0.8 * v + 0.2 * this.velocity;\r\n  }\r\n\r\n  momentumScroll(stopPoint) {\r\n    if (this.destroyed) {\r\n      return;\r\n    }\r\n\r\n    if(this.amplitude) {\r\n      const elapsed = Date.now() - this.timestamp;\r\n\r\n      const delta = -this.amplitude * Math.exp(-elapsed / (this.config.decelerationRate));\r\n\r\n      if(delta > stopPoint || delta < -stopPoint) {\r\n        const outOfBoundsLeft = this.target+delta > 0;\r\n        const outOfBoundsRight = this.target+delta < -this.cardWidth * this.cards.length + (this.cardWidth);\r\n        if(outOfBoundsLeft || outOfBoundsRight) {\r\n          return this.snap(this.index);\r\n        }\r\n        this.translate(this.target + delta, 0);\r\n        window.requestAnimationFrame(_ => this.momentumScroll(stopPoint));\r\n      } else {\r\n        this.snap(this.index);\r\n      }\r\n    }\r\n  }\r\n\r\n  onDragMove(e) {\r\n    const touches =  e.touches ? e.touches[0] : e;\r\n    const {pageX, pageY} = touches;\r\n    const move = {\r\n      x: pageX - this.startX,\r\n      y: pageY - this.startY\r\n    };\r\n\r\n    // Keep track of the total distance moved right/left in the move\r\n    this.totalMove.x += Math.abs(move.x - this.lastPos.x);\r\n    this.totalMove.y += Math.abs(move.y - this.lastPos.y);\r\n    this.lastPos = {\r\n      x: move.x,\r\n      y: move.y\r\n    };\r\n\r\n    // Don't do anything if the move doesn't exceed our threshold\r\n    if (this.totalMove.x < this.config.moveThreshold && this.totalMove.y < this.config.moveThreshold) {\r\n      return;\r\n    }\r\n\r\n    // If the swipe is vertical, allow page to scroll instead of moving carousel\r\n    if(this.totalMove.x > this.totalMove.y) {\r\n      e.preventDefault();\r\n\r\n      this.translate(this.lastTranslate + move.x, 0);\r\n      this.velocity = this.calcVelocity();\r\n\r\n    }\r\n  }\r\n\r\n  calculateIndex() {\r\n    let index = Math.round(-this.currentTranslate / this.cardWidth);\r\n    return Math.max(0, Math.min(this.cards.length-1, (index)));\r\n  }\r\n\r\n  onDotClick(e) {\r\n    let i = this.dots.indexOf(e.target);\r\n    this.setIndex(i);\r\n    this.snap(this.index);\r\n  }\r\n\r\n  onDotKey(e) {\r\n    if (e.keyCode === 32 || e.keyCode === 13) {\r\n      let i = this.dots.indexOf(e.target);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      this.setIndex(i);\r\n      this.snap(this.index);\r\n    }\r\n  }\r\n\r\n  setIndex(index: number) {\r\n    const oldIndex = this.index;\r\n    \r\n    // Don't let index go outside bounds\r\n    this.index = Math.max(Math.min(index, this.cards.length-1), 0);\r\n\r\n    // Update dots, TODO: animate this\r\n    if (oldIndex !== this.index && this.dots && this.dots[oldIndex] && this.dots[this.index]) {\r\n      this.dots[oldIndex].className = '';\r\n      this.dots[this.index].className = 'active';\r\n    }\r\n  }\r\n\r\n  snap(nextIndex? : number, direction? : string, instant? : boolean) {\r\n    if(direction) {\r\n      direction == 'right' ? nextIndex = this.index+1 : nextIndex = this.index-1;\r\n    } else if(nextIndex !== undefined) {\r\n      nextIndex = Math.min(Math.max(nextIndex, 0), this.cards.length - 1);\r\n    } else {\r\n      return;\r\n    }\r\n    this.index = nextIndex;\r\n\r\n    const nextOffset = this.calcOS(this.index);\r\n\r\n    const ease = 'ease';\r\n    const distance = Math.abs(this.currentTranslate - nextOffset);\r\n\r\n    const duration = instant ? 200 : Math.floor(distance*1.25) + this.config.snapSpeedConstant;\r\n\r\n    this.translate(nextOffset, duration, ease);\r\n  }\r\n\r\n  onDragEnd() {\r\n    this.carousel.removeEventListener('mousemove', this.callbacks.onDragMove);\r\n    this.carousel.removeEventListener('touchmove', this.callbacks.onDragMove);\r\n    \r\n    this.carousel.removeEventListener('touchend',this.callbacks.onDragEnd);\r\n    this.carousel.removeEventListener('mouseup', this.callbacks.onDragEnd);\r\n    this.carousel.removeEventListener('mouseleave', this.callbacks.onDragEnd);\r\n\r\n    window.clearInterval(this.velocityInterval);\r\n    if(this.velocity > 0.5 || this.velocity < -0.5) {\r\n      this.amplitude = (1-this.config.heaviness) * this.velocity;\r\n      this.target = Math.round(this.currentTranslate + this.amplitude);\r\n\r\n      window.requestAnimationFrame(_ => this.momentumScroll(this.config.momentumSnapVelocityThreshold));\r\n    } else {\r\n      this.snap(this.index);\r\n    }\r\n  }\r\n\r\n  translate(x : number, length : number, fn? : string, updateIndex : boolean = true) {\r\n    this.currentTranslate = x;\r\n    this.carousel.style['transition'] = 'transform';\r\n    this.carousel.style['transitionDuration'] = `${length}ms`;\r\n    this.carousel.style['transform'] = `translate3d(${x}px,0px,0px)`;\r\n    if(fn) {\r\n      this.carousel.style['transitionTimingFunction'] = fn;\r\n    }\r\n    if(length === 0 && updateIndex) {\r\n      // We only want to calculate the index if we're responding to a user drag\r\n      // i.e. a 0 length transition\r\n      this.setIndex(this.calculateIndex());\r\n    }\r\n    window.requestAnimationFrame(_ => this.rescale());\r\n  }\r\n\r\n  proportionVisible(index : number) {\r\n    const cardRect = {\r\n      left: this.currentTranslate + (this.cardWidth * index),\r\n      right: this.currentTranslate + (this.cardWidth * (index + 1))\r\n    };\r\n\r\n    if (cardRect.right < this.carouselParent.left || cardRect.left > this.carouselParent.right) {\r\n      return 0;\r\n    } else if (cardRect.left < this.carouselParent.left) {\r\n      return (cardRect.right - this.carouselParent.left) / this.cardWidth;\r\n    } else if (cardRect.right > this.carouselParent.right) {\r\n      return (this.carouselParent.right - cardRect.left) / this.cardWidth;\r\n    } else {\r\n      return 1;\r\n    }\r\n  }\r\n\r\n  rescale() {\r\n    if (this.destroyed) {\r\n      return;\r\n    }\r\n\r\n    // Rescale current card and 2 cards in either direction\r\n    const from = Math.max(this.index-2 ,0);\r\n    const to = Math.min(this.index+2, this.cards.length-1);\r\n \r\n    for(let i = from; i<=to; i++) {\r\n      const scaler = Math.min(Math.max(this.proportionVisible(i)+0.25, this.config.minCardScale), 1);\r\n\r\n      this.cards[i].style['transform'] = `scale(${scaler})`;\r\n      this.cards[i].style['transitionTimingFunction'] = 'ease';\r\n      this.cards[i].style['transitionDuration'] = `${this.config.shrinkSpeed}ms`;\r\n    }\r\n  }\r\n\r\n  calcOS(i) {\r\n    // Width of container - Width of card = All the extra space\r\n    // Divide this by 2 to get desired distance from edge on either side of card\r\n    const edgeToCardDist = (this.carouselParent.width - this.cardWidth)/2;\r\n\r\n    // Translating to the left of the desired card, minus our desired edge dist\r\n    // Multiplied by -1 because we are translating to the right\r\n    //let centeredPosition = (this.cardWidth*i - edgeToCardDist + this.carouselParent.left) * -1;\r\n    let centeredPosition = (this.cardWidth*i - edgeToCardDist) * -1;\r\n\r\n    if (this.cards.length <= 1) {             //If there's only one item, center it\r\n      return centeredPosition;\r\n    } else if (i === 0) {                     //If it's the first of multiple, align left\r\n      return 0;\r\n    } else if (i === this.cards.length - 1) { //If it's the last of multiple, align right\r\n      return (this.carouselParent.width - this.cardWidth) - (this.cardWidth * (this.cards.length - 1));\r\n    } else {                                  //Otherwise it's in the middle of multiple, so center it\r\n      return centeredPosition;\r\n    }\r\n  }\r\n\r\n  cleanUp() {\r\n    this.removeDots(true);\r\n    this.carousel.removeEventListener('touchstart', this.callbacks.onDragStart);\r\n    this.carousel.removeEventListener('mousedown', this.callbacks.onDragStart);\r\n    this.carousel.removeEventListener('transitionend', this.callbacks.onTransitionEnd);\r\n    this.carousel.removeEventListener('click', this.callbacks.onClick);\r\n    window.removeEventListener('resize', this.callbacks.onWindowResize);\r\n    if (this.resizeTimeoutId) {\r\n      clearTimeout(this.resizeTimeoutId);\r\n    }\r\n    this.destroyed = true;\r\n  }\r\n\r\n  removeDots(includingContainer : boolean = false) {\r\n    while (this.dots.length > 0) {\r\n      let dot = this.dots.pop();\r\n      if (dot === undefined) {\r\n        continue;\r\n      }\r\n      dot.removeEventListener('touchstart', this.callbacks.onDotClick);\r\n      dot.removeEventListener('click', this.callbacks.onDotClick);\r\n      dot.removeEventListener('keydown', this.callbacks.onDotKey);\r\n      this.dotContainer.removeChild(dot);\r\n    }\r\n    if (includingContainer && this.dotContainer && this.dotContainer.parentElement) {\r\n       this.dotContainer.parentElement.removeChild(this.dotContainer);\r\n    }\r\n  }\r\n\r\n  setupConfig(config?) {\r\n    const defaultConfig = {\r\n      decelerationRate: 700, // How fast we decelerate\r\n      momentumSnapVelocityThreshold: 105, // Velocity at which cards snap\r\n      minCardScale: 0.9, // Smallest that partially-viewable cards can scale to\r\n      snapSpeedConstant: 300, // Constant ms to be added to snapping duration\r\n      heaviness: 0.675, // Scale of 0 to 1, higher = less momentum after release\r\n      shrinkSpeed: 150, // Speed of card scaling transition, in ms\r\n      moveThreshold: 10, // Min accumulative x + y distance travelled by pointer before carousel will move and click events are cancelled\r\n      enableDots: true,\r\n      includeStyle: false\r\n    };\r\n    return assign({}, defaultConfig, config);\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}